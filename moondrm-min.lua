if MoonDRM then return end;local a={}local b=a;local c=math.floor;local d=2^32;local e=d-1;local function f(g)local h={}local i=setmetatable({},h)function h:__index(j)local k=g(j)i[j]=k;return k end;return i end;local function l(i,m)local function n(o,p)local q,r=0,1;while o~=0 and p~=0 do local s,t=o%m,p%m;q=q+i[s][t]*r;o=(o-s)/m;p=(p-t)/m;r=r*m end;q=q+(o+p)*r;return q end;return n end;local function u(i)local v=l(i,2^1)local w=f(function(o)return f(function(p)return v(o,p)end)end)return l(w,2^(i.n or 1))end;function a.tobit(x)return x%2^32 end;a.bxor=u{[0]={[0]=0,[1]=1},[1]={[0]=1,[1]=0},n=4}local y=a.bxor;function a.bnot(o)return e-o end;local z=a.bnot;function a.band(o,p)return(o+p-y(o,p))/2 end;local A=a.band;function a.bor(o,p)return e-A(e-o,e-p)end;local B=a.bor;local C,D;function a.rshift(o,E)if E<0 then return C(o,-E)end;return c(o%2^32/2^E)end;D=a.rshift;function a.lshift(o,E)if E<0 then return D(o,-E)end;return o*2^E%2^32 end;C=a.lshift;function a.tohex(x,F)F=F or 8;local G;if F<=0 then if F==0 then return''end;G=true;F=-F end;x=A(x,16^F-1)return('%0'..F..(G and'X'or'x')):format(x)end;local H=a.tohex;function a.extract(F,I,J)J=J or 1;return A(D(F,I),2^J-1)end;local K=a.extract;function a.replace(F,k,I,J)J=J or 1;local L=2^J-1;k=A(k,L)local M=z(C(L,I))return A(F,M)+C(k,I)end;local N=a.replace;function a.bswap(x)local o=A(x,0xff)x=D(x,8)local p=A(x,0xff)x=D(x,8)local O=A(x,0xff)x=D(x,8)local P=A(x,0xff)return C(C(C(o,8)+p,8)+O,8)+P end;local Q=a.bswap;function a.rrotate(x,E)E=E%32;local R=A(x,2^E-1)return D(x,E)+C(R,32-E)end;local S=a.rrotate;function a.lrotate(x,E)return S(x,-E)end;local T=a.lrotate;a.rol=a.lrotate;a.ror=a.rrotate;function a.arshift(x,E)local U=D(x,E)if x>=0x80000000 then U=U+C(2^E-1,32-E)end;return U end;local V=a.arshift;function a.btest(x,W)return A(x,W)~=0 end;a.bit32={}local function X(x)return(-1-x)%d end;a.bit32.bnot=X;local function Y(o,p,O,...)local U;if p then o=o%d;p=p%d;U=y(o,p)if O then U=Y(U,O,...)end;return U elseif o then return o%d else return 0 end end;a.bit32.bxor=Y;local function Z(o,p,O,...)local U;if p then o=o%d;p=p%d;U=(o+p-y(o,p))/2;if O then U=Z(U,O,...)end;return U elseif o then return o%d else return e end end;a.bit32.band=Z;local function _(o,p,O,...)local U;if p then o=o%d;p=p%d;U=e-A(e-o,e-p)if O then U=_(U,O,...)end;return U elseif o then return o%d else return 0 end end;a.bit32.bor=_;function a.bit32.btest(...)return Z(...)~=0 end;function a.bit32.lrotate(x,E)return T(x%d,E)end;function a.bit32.rrotate(x,E)return S(x%d,E)end;function a.bit32.lshift(x,E)if E>31 or E<-31 then return 0 end;return C(x%d,E)end;function a.bit32.rshift(x,E)if E>31 or E<-31 then return 0 end;return D(x%d,E)end;function a.bit32.arshift(x,E)x=x%d;if E>=0 then if E>31 then return x>=0x80000000 and e or 0 else local U=D(x,E)if x>=0x80000000 then U=U+C(2^E-1,32-E)end;return U end else return C(x,-E)end end;function a.bit32.extract(x,I,...)local J=...or 1;if I<0 or I>31 or J<0 or I+J>32 then error'out of range'end;x=x%d;return K(x,I,...)end;function a.bit32.replace(x,k,I,...)local J=...or 1;if I<0 or I>31 or J<0 or I+J>32 then error'out of range'end;x=x%d;k=k%d;return N(x,k,I,...)end;a.bit={}function a.bit.tobit(x)x=x%d;if x>=0x80000000 then x=x-d end;return x end;local a0=a.bit.tobit;function a.bit.tohex(x,...)return H(x%d,...)end;function a.bit.bnot(x)return a0(z(x%d))end;local function a1(o,p,O,...)if O then return a1(a1(o,p),O,...)elseif p then return a0(B(o%d,p%d))else return a0(o)end end;a.bit.bor=a1;local function a2(o,p,O,...)if O then return a2(a2(o,p),O,...)elseif p then return a0(A(o%d,p%d))else return a0(o)end end;a.bit.band=a2;local function a3(o,p,O,...)if O then return a3(a3(o,p),O,...)elseif p then return a0(y(o%d,p%d))else return a0(o)end end;a.bit.bxor=a3;function a.bit.lshift(x,F)return a0(C(x%d,F%32))end;function a.bit.rshift(x,F)return a0(D(x%d,F%32))end;function a.bit.arshift(x,F)return a0(V(x%d,F%32))end;function a.bit.rol(x,F)return a0(T(x%d,F%32))end;function a.bit.ror(x,F)return a0(S(x%d,F%32))end;function a.bit.bswap(x)return a0(Q(x%d))end;local a4=b.bxor;local a5={}a5.size=function(a6)return#a6 end;a5.fromstring=function(string)local a7={}local a8=1;local a9=string.byte(string,a8)while a9~=nil do a7[a8]=a9;a8=a8+1;a9=string.byte(string,a8)end;return a7 end;a5.tostring=function(a7)local aa={}local a8=1;local a9=a7[a8]while a9~=nil do aa[a8]=string.char(a9)a8=a8+1;a9=a7[a8]end;return table.concat(aa,"")end;a5.fromStream=function(ab)local a6={}local a8=1;local a9=ab()while a9~=nil do a6[a8]=a9;a8=a8+1;a9=ab()end;return a6 end;a5.readFromQueue=function(ac,ad)local a6={}for a8=1,ad do a6[a8]=ac.pop()end;return a6 end;a5.writeToQueue=function(ac,a6)local ad=a5.size(a6)for a8=1,ad do ac.push(a6[a8])end end;a5.toStream=function(a6)local ac=Queue()local a8=1;local a9=a6[a8]while a9~=nil do ac.push(a9)a8=a8+1;a9=a6[a8]end;return ac.pop end;local ae={}for a8=0,255 do ae[string.format("%02X",a8)]=a8;ae[string.format("%02x",a8)]=a8 end;a5.fromHex=function(af)local a6={}for a8=1,string.len(af)/2 do local ag=string.sub(af,a8*2-1,a8*2)a6[a8]=ae[ag]end;return a6 end;local ah={}for a8=0,255 do ah[a8]=string.format("%02X",a8)end;a5.toHex=function(a6)local af={}local a8=1;local a9=a6[a8]while a9~=nil do af[a8]=ah[a9]a8=a8+1;a9=a6[a8]end;return table.concat(af,"")end;a5.concat=function(o,p)local ai={}local aj=1;local a8=1;local a9=o[a8]while a9~=nil do ai[aj]=a9;a8=a8+1;aj=aj+1;a9=o[a8]end;local a8=1;local a9=p[a8]while a9~=nil do ai[aj]=a9;a8=a8+1;aj=aj+1;a9=p[a8]end;return ai end;a5.truncate=function(o,ak)local x={}for a8=1,ak do x[a8]=o[a8]end;return x end;a5.XOR=function(o,p)local x={}for j,k in pairs(o)do x[j]=a4(k,p[j])end;return x end;a5.substitute=function(al,am)local aj={}for j,k in pairs(al)do aj[j]=am[k]end;return aj end;a5.permute=function(al,an)local aj={}for j,k in pairs(an)do aj[j]=al[k]end;return aj end;a5.copy=function(al)local aj={}for j,k in pairs(al)do aj[j]=k end;return aj end;a5.slice=function(al,ao,ap)local aj={}for a8=ao,ap do aj[a8-ao+1]=al[a8]end;return aj end;local Queue=function()local ac={}local aq=0;local ar=0;local as={}as.push=function(at)ac[ar]=at;ar=ar+1;return end;as.pop=function()if aq<ar then local at=ac[aq]ac[aq]=nil;aq=aq+1;return at else return nil end end;as.size=function()return ar-aq end;as.getHead=function()return ar end;as.getTail=function()return aq end;as.reset=function()ac={}ar=0;aq=0 end;return as end;local au={}au.fromstring=function(string)local a8=0;return function()a8=a8+1;if a8<=string.len(string)then return string.byte(string,a8)else return nil end end end;au.tostring=function(ab)local a6={}local a8=1;local a9=ab()while a9~=nil do a6[a8]=string.char(a9)a8=a8+1;a9=ab()end;return table.concat(a6,"")end;au.fromArray=function(a6)local ac=Queue()local a8=1;local a9=a6[a8]while a9~=nil do ac.push(a9)a8=a8+1;a9=a6[a8]end;return ac.pop end;au.toArray=function(ab)local a6={}local a8=1;local a9=ab()while a9~=nil do a6[a8]=a9;a8=a8+1;a9=ab()end;return a6 end;local ae={}for a8=0,255 do ae[string.format("%02X",a8)]=a8;ae[string.format("%02x",a8)]=a8 end;au.fromHex=function(af)local ac=Queue()for a8=1,string.len(af)/2 do local ag=string.sub(af,a8*2-1,a8*2)ac.push(ae[ag])end;return ac.pop end;local ah={}for a8=0,255 do ah[a8]=string.format("%02X",a8)end;au.toHex=function(ab)local af={}local a8=1;local a9=ab()while a9~=nil do af[a8]=ah[a9]a8=a8+1;a9=ab()end;return table.concat(af,"")end;local av=b.band;local aw=b.bor;local ax=b.bnot;local a4=b.bxor;local ay=b.lrotate;local az=b.rrotate;local aA=b.lshift;local aB=b.rshift;local aC={[0]="A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"}local aD={}for j,k in pairs(aC)do aD[j]=k;aD[k]=j end;local aE={}aE.fromStream=function(ab)local aF=0x00;local aG=0;local aH={}local a9=ab()while a9~=nil do aF=aw(aA(aF,8),a9)aG=aG+8;while aG>=6 do aG=aG-6;local aI=aB(aF,aG)table.insert(aH,aD[aI])aF=av(aF,ax(aA(0xFFFFFFFF,aG)))end;a9=ab()end;if aG==4 then aF=aA(aF,2)table.insert(aH,aD[aF])table.insert(aH,"=")elseif aG==2 then aF=aA(aF,4)table.insert(aH,aD[aF])table.insert(aH,"==")end;return table.concat(aH,"")end;aE.fromArray=function(a6)local aF=0x00;local aG=0;local aH={}local aJ=1;local a9=a6[aJ]aJ=aJ+1;while a9~=nil do aF=aw(aA(aF,8),a9)aG=aG+8;while aG>=6 do aG=aG-6;local aI=aB(aF,aG)table.insert(aH,aD[aI])aF=av(aF,ax(aA(0xFFFFFFFF,aG)))end;a9=a6[aJ]aJ=aJ+1 end;if aG==4 then aF=aA(aF,2)table.insert(aH,aD[aF])table.insert(aH,"=")elseif aG==2 then aF=aA(aF,4)table.insert(aH,aD[aF])table.insert(aH,"==")end;return table.concat(aH,"")end;aE.fromstring=function(string)return aE.fromArray(a5.fromstring(string))end;aE.toStream=function(aH)return au.fromArray(aE.toArray(aH))end;aE.toArray=function(aH)local aF=0x00;local aG=0;local a7={}for O in string.gmatch(aH,".")do if O=="="then aF=aB(aF,2)aG=aG-2 else aF=aA(aF,6)aG=aG+6;aF=aw(aF,aD[O])end;while aG>=8 do aG=aG-8;local aI=aB(aF,aG)table.insert(a7,aI)aF=av(aF,ax(aA(0xFFFFFFFF,aG)))end end;return a7 end;aE.tostring=function(aH)local aF=0x00;local aG=0;local aa={}for O in string.gmatch(aH,".")do if O=="="then aF=aB(aF,2)aG=aG-2 else aF=aA(aF,6)aG=aG+6;aF=aw(aF,aD[O])end;while aG>=8 do aG=aG-8;local aI=aB(aF,aG)table.insert(aa,string.char(aI))aF=av(aF,ax(aA(0xFFFFFFFF,aG)))end end;return table.concat(aa,"")end;function MoonDRM(aK,aL)sql.Query("CREATE TABLE IF NOT EXISTS `moondrm` (`script_id` INT NOT NULL, `version` VARCHAR NOT NULL, `code` TEXT NOT NULL, UNIQUE (`script_id`,`version`) ON CONFLICT REPLACE)")aL=aL or{}if not(aL.ScriptName or aK.ScriptID)then error("You need to provide ScriptName or ScriptID. https://panel.moondrm.com/docs/")end;if not aK.ID then error("You need to provide ID. https://panel.moondrm.com/docs/")end;if not aK.Version then error("You need to provide Version. https://panel.moondrm.com/docs/")end;if _G.debug.getinfo(_G.RunString).short_src=="[C]"then if system.IsWindows()then aK["OS"]=0 elseif system.IsLinux()then aK["OS"]=1 elseif system.IsOSX()then aK["OS"]=2 end;aK["CC"]=system.GetCountry()aK["IP"]=game.GetIPAddress():gsub(":.*","")aK["Port"]=game.GetIPAddress():gsub(".-:","")aK["Hostname"]=GetConVar("hostname"):GetString()http.Post("https://api.moondrm.com/",aK,function(aM)if aM:find("#MoonDRM#")then aM:gsub("#MoonDRM#","")local aN=0;for aO,k in pairs(string.ToTable(aL.ID))do if tonumber(k)then aN=aN+tonumber(k)end end;aM=a5.toString(aE.toArray(aM))local aP=""for aO,k in pairs(string.Explode(",",aM))do if tonumber(k)then aP=aP..string.char(tonumber(k)-aN)else aP=aP..k end end;aM=a5.toString(aE.toArray(aM))sql.Query("REPLACE INTO `moondrm` (`script_id`,`version`,`code`) VALUES("..sql.SQLStr(aK.ScriptID)..","..sql.SQLStr(aK.Version)..","..sql.SQLStr(aM)..")")if _G.debug.getinfo(_G.RunString).short_src=="[C]"then _G.RunString(aM,aL.ScriptName or aK.ScriptID)elseif aK.ID then http.Post("https://panel.moondrm.com/detour.php",{ID=aK.ID})end elseif aM:find("--#Lua#")then RunString(aM,"MoonDRM")end end)elseif aK.ID then http.Post("https://panel.moondrm.com/detour.php",{ID=aK.ID})end end